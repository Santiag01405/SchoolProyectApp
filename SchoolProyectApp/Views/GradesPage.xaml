<?xml version="1.0" encoding="utf-8" ?>
<ContentPage xmlns="http://schemas.microsoft.com/dotnet/2021/maui"
             xmlns:x="http://schemas.microsoft.com/winfx/2009/xaml"
             xmlns:vm="clr-namespace:SchoolProyectApp.ViewModels"
             xmlns:local="clr-namespace:SchoolProyectApp.Views"
             x:Class="SchoolProyectApp.Views.GradesPage"
             xmlns:toolkit="http://schemas.microsoft.com/dotnet/2022/maui/toolkit"
             xmlns:droid="clr-namespace:CommunityToolkit.Maui.PlatformConfiguration.AndroidSpecific;assembly=CommunityToolkit.Maui"
             droid:NavigationBar.Color="white"
             droid:NavigationBar.Style="LightContent"
             Title="Mis Calificaciones">

	<ContentPage.Behaviors>
		<toolkit:StatusBarBehavior StatusBarColor="#0C4251"
                                   StatusBarStyle="LightContent" />
	</ContentPage.Behaviors>

	<ContentPage.BindingContext>
		<vm:GradesViewModel />
	</ContentPage.BindingContext>

    <AbsoluteLayout>

        <ContentView x:Name="MainContent"
                     AbsoluteLayout.LayoutBounds="0,10,1,0.85"
                     AbsoluteLayout.LayoutFlags="WidthProportional,HeightProportional">
			<ScrollView>
				<StackLayout Padding="20" Spacing="15">
                    <Label Text="Calificaciones" 
                       FontAttributes="Bold" 
                       FontSize="32" 
                       HorizontalOptions="Center"
                           TextColor="#f1c864"
                     />
                    

                        <Label Text="Promedio General del Estudiante" FontSize="20" FontAttributes="Bold" HorizontalOptions="Center" />
                        <Label Text="{Binding StudentOverallAverage}" FontSize="40" FontAttributes="Bold" HorizontalOptions="Center" TextColor="Green" />

                    <CollectionView ItemsSource="{Binding GradesByCourse}">
                        <CollectionView.ItemTemplate>
                            <DataTemplate>
                                <Border Stroke="#E0E0E0"
                                        StrokeThickness="1"
                                        Padding="15"
                                        Margin="0,0,0,15">
                                    <Border.StrokeShape>
                                        <RoundRectangle CornerRadius="10"/>
                                    </Border.StrokeShape>
                                    <Border.Shadow>
                                        <Shadow Brush="#000" Opacity="0.1" Radius="10" Offset="5,5"/>
                                    </Border.Shadow>

                                    <StackLayout Spacing="10">
                                        <Label Text="{Binding Curso}" 
                                               FontSize="18" 
                                               FontAttributes="Bold" 
                                               TextColor="#0C4251"/>

                                        <BoxView HeightRequest="1" Color="#E0E0E0" />

                                        <StackLayout BindableLayout.ItemsSource="{Binding Calificaciones}" Spacing="10">
                                            <BindableLayout.ItemTemplate>
                                                <DataTemplate>
                                                    <Grid ColumnDefinitions="*,Auto" RowSpacing="2">

                                                        <StackLayout Grid.Column="0">
                                                            <Label Text="{Binding Evaluacion}" 
                                                                   FontSize="16" 
                                                                   TextColor="Black"
                                                                   FontAttributes="Bold"/>
                                                            <Label Text="{Binding Comments}" 
                                                                   FontSize="12" 
                                                                   TextColor="Gray"/>
                                                        </StackLayout>

                                                        <Label Grid.Column="1"
                                                               Text="{Binding GradeValue, StringFormat='{0:F2}'}" 
                                                               FontSize="18"
                                                               FontAttributes="Bold"
                                                               TextColor="#006400"
                                                               VerticalOptions="Center"/>
                                                    </Grid>
                                                </DataTemplate>
                                            </BindableLayout.ItemTemplate>
                                        </StackLayout>
                                    </StackLayout>
                                </Border>
                            </DataTemplate>
                        </CollectionView.ItemTemplate>
                    </CollectionView>
                </StackLayout>
			</ScrollView>
		</ContentView>

		<ContentView x:Name="SideMenu"
                     WidthRequest="260"
                     BackgroundColor="#0C4251"
                     IsVisible="False"
                     TranslationX="-260"
                     AbsoluteLayout.LayoutBounds="0,0,260,1"
                     AbsoluteLayout.LayoutFlags="PositionProportional,HeightProportional">
			<local:MenuPage />
		</ContentView>

		<Grid BackgroundColor="WhiteSmoke" Padding="10"
              AbsoluteLayout.LayoutBounds="0,1,1,80"
              AbsoluteLayout.LayoutFlags="WidthProportional,PositionProportional">
			<Grid.ColumnDefinitions>
				<ColumnDefinition Width="*" />
				<ColumnDefinition Width="*" />
				<ColumnDefinition Width="*" />
			</Grid.ColumnDefinitions>

			<StackLayout Grid.Column="0" HorizontalOptions="Center">
				<Button Text="&#xf015;" FontFamily="FontAwesomeSolid" FontSize="24"
                        TextColor="#0C4251" BackgroundColor="WhiteSmoke" Command="{Binding HomeCommand}" />
				<Label Text="Inicio" FontSize="10" HorizontalOptions="Center" />
			</StackLayout>

			<StackLayout Grid.Column="1" HorizontalOptions="Center">
				<Button Text="&#xf007;" FontFamily="FontAwesomeSolid" FontSize="24"
                        TextColor="#0C4251" BackgroundColor="WhiteSmoke" Command="{Binding FirstProfileCommand}" />
				<Label Text="Perfil" FontSize="10" HorizontalOptions="Center" />
			</StackLayout>

			<StackLayout Grid.Column="2" HorizontalOptions="Center">
				<Button Text="&#xf0c9;" FontFamily="FontAwesomeSolid" FontSize="24"
                        TextColor="#0C4251" BackgroundColor="WhiteSmoke"
                        Clicked="MenuButton_Clicked" />
				<Label Text="MenÃº" FontSize="10" HorizontalOptions="Center" />
			</StackLayout>
		</Grid>
	</AbsoluteLayout>
</ContentPage>

